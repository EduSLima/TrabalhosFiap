---
title: "ANALISE DO DATASET WINE QUALITY"
author: "RM334304 - EDUARDO SIQUEIRA DE LIMA"
output: html_notebook
---

&nbsp; 

###  **"Conceitos Estatísticos para IA"**  
####  *Prof. Adelaide Alves de Oliveira*

&nbsp;
&nbsp;

Inicicalmente vamos instalar os pacotes, caso seja necessário, que serão usados no decorrer da análise
```{r}

#ignorando alertas para não poluir a exibição do markdwon
options(warn =-1)

#lista de pacotes que iremos utilizar no projeto
Pacotes_Necessarios <- c("ggplot2","readr","dplyr", "corrgram","corrplot", "plotly","skimr","gridExtra","GGally")

#com base nos pacotes instalados crio uma variavel somente com os pacotes que não temos ainda para realizar a instalação 
#dos pacotes que de fato não possuimos
PacotesNovos <- Pacotes_Necessarios[!(Pacotes_Necessarios %in% installed.packages()[,"Package"])]
if(length(PacotesNovos)){ install.packages(PacotesNovos)} else {print("Todos os Pacotes Estão Instalados")}

```



Carregando todas as as Bibliotecas mencionadas no passo anterior
```{r}
lapply(Pacotes_Necessarios, require, character.only = TRUE)
```



Importando os Datasets de Wines Quality.

Os dados foram obtidos do site: https://archive.ics.uci.edu/ml/datasets/wine+quality, 2 arquivos foram baixados:

1. winequality-red.csv    *(dados dos vinhos tintos)*
2. winequality-white.csv  *(dados dos vinhos brancos)*

Analisando o arquivo antes de importar notamos que os nomes das colunas não são os mais amigaveis para fazer uma análise uma vez que alguns deles estão separados por espaço neste caso antes de subir iremos normaliza-los, para tal criaremos um array de nomes para passar como parâmetro no momento da carga dos dados

&nbsp;
&nbsp;


#### Lista DE - PARA das colunas



Nome no Arquivo     |  Nome Traduzido
----------------    |-----------------
fixed acidity       |acidez_fixa
volatile acidity    |acidez_volatil
citric acid         |acido_citrico	
residual sugar      |acucar_residual
chlorides           |cloretos
free sulfur dioxide |fsd
total sulfur dioxide|tsd
density             |densidade
pH                  |PH
sulphates           |sulfatos
alcohol             |grau_alcolico
quality             |qualidade


```{r, results="hide"}

#Criando uma variável nome_colunas que receberá os nomes das colunas que normalizaremos a fim de facilitar o resto da análise
nome_colunas <- c("acidez_fixa","acidez_volatil","acido_citrico","acucar_residual","cloretos", "fsd", "tsd","densidade","PH", "sulfatos","grau_alcolico","qualidade")

#uso da biblioteca readr é para obter uma performance de carga melhor que a lib padrão do R
vinho_branco <- read_delim("./DataSets/winequality-white.csv" ,delim = ";", col_names = nome_colunas, skip = 1)

vinho_tinto  <- read_delim("./DataSets/winequality-red.csv"   ,delim = ";", col_names = nome_colunas, skip = 1)

```


Juntando os 2 DataSets em um único adicionando novas colunas que definem o tipo do vinho se é Tinto ou Branco e uma classificação de bom ou ruim de acordo com sua nota, onde menor que 5 é ruim até 7 bom e acima disso excelentte

```{r}

#Adicionando coluna tipo de vinho
vinho_branco$tipo <- "Branco"
vinho_tinto$tipo <- "Tinto"

#juntando os 2 datasets
vinhos <- rbind.data.frame(vinho_branco,vinho_tinto)

#converte tipo paara fator
vinhos$tipo <- factor(vinhos$tipo, ordered = T)

#Criando uma coluna de Ranking para dizer o quão bom é o vinho
vinhos$rating <- factor(ifelse(vinhos$qualidade <= 5, 'Ruim', ifelse(vinhos$qualidade <= 7, 'Bom', 'Excelente')))

```



Exibindo os dados das dimensões, sumário, estrutura e as primeiras linhas do DataFrame Vinhos

```{r ,results="hide"}

attach(vinhos)

```

```{r}
#demonstrando as quantidades de dimensoes de ambos datasets

dim(vinhos)
skim(vinhos)
str(vinhos)
head (vinhos,3)

```


Distribuição da Qualidade do Vinho por tipo de vinho e classificação

```{r}

grafico_1 <- qplot(qualidade, data = vinhos, fill = tipo, binwidth = 1)  
grafico_2 <- qplot(qualidade, data = vinhos, fill = rating, binwidth = 1) 

grid.arrange(grafico_1, grafico_2, ncol=2)

```


Observa-se que as qualidades dos vinhos se encontram em uma distribuição normal. Sabe -se que a maior concentração de notas está na regão entre nota 3 e 9. Entretando, antes de aprofundarmos em qualquer análise que envolvem os dados é necessário pontuar se há existencia de outliers e remove-los caso existam

O comando aplicado para todos atributos abaixo exibição dos box-plot abaixo foi:

> *boxplot(Column_Name, col="slategray2", pch=19) * <br />
> *mtext("Titulo" , cex=0.8, side=1, line=2)*

```{r, , echo=FALSE}

par(mfrow=c(1,6), oma = c(1,1,0,0) + 0.1,  mar = c(3,3,1,1) + 0.1)
  boxplot(acidez_fixa, col="slategray2", pch=19)
  mtext("Acidez Fixa" , cex=0.8, side=1, line=2)
  boxplot(acidez_volatil, col="slategray2", pch=19)
  mtext("Acidez Volatil", cex=0.8, side=1, line=2)
  boxplot(acido_citrico, col="slategray2", pch=19)
  mtext("acido_citrico", cex=0.8, side=1, line=2)
  boxplot(acucar_residual, col="slategray2", pch=19)
  mtext("acucar_residual", cex=0.8, side=1, line=2)
  boxplot(cloretos, col="slategray2", pch=19)
  mtext("cloretos", cex=0.8, side=1, line=2)
  boxplot(fsd, col="slategray2", pch=19)
  mtext("fsd", cex=0.8, side=1, line=2)

```



```{r, , echo=FALSE}

par(mfrow=c(1,5), oma = c(1,1,0,0) + 0.1,  mar = c(3,3,1,1) + 0.1)
  boxplot(tsd, col="slategray2", pch=19)
  mtext("tsd" , cex=0.8, side=1, line=2)
  boxplot(densidade, col="slategray2", pch=19)
  mtext("densidade", cex=0.8, side=1, line=2)
  boxplot(PH, col="slategray2", pch=19)
  mtext("PH", cex=0.8, side=1, line=2)
  boxplot(sulfatos, col="slategray2", pch=19)
  mtext("sulfatos", cex=0.8, side=1, line=2)
  boxplot(grau_alcolico, col="slategray2", pch=19)
  mtext("grau_alcolico", cex=0.8, side=1, line=2)
  
```

Nota se que todas as variáveis possuem outliers e para uma melhor acurácia no modelo iremos removê-las da análise inicial 


```{r}

#criando uma funcao para remover os outliers das colunas 
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}

```
